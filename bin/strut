#!/usr/bin/env python

import sys
from parser import HttpRequest
from renderers.swagger import SwaggerRenderer

def swagger_json(requests):
    return SwaggerRenderer.json(requests)

def swagger_yaml(requests):
    return SwaggerRenderer.yaml(requests)


ACTIONS = {
  'swagger': swagger_yaml,
  'swagger-yaml': swagger_yaml,
  'swagger-json': swagger_json,
}


if __name__ == "__main__":

  if len(sys.argv) < 2:
     sys.stdout.write("strut {swagger} filename.http")
     quit()

  action = sys.argv[1]
  filename = sys.argv[2]

  method = ACTIONS.get(action)

  requests = HttpRequest.parse_file(filename)

  sys.stdout.write(method(requests))

